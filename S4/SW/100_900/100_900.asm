ORG 0
CZAS_50 EQU 65535 - 46080 + 1
D7 EQU P2.0
LICZNIK EQU R6
NrCYKL_ON  EQU 18
NrCYKL_OFF EQU 2
MOV P2,#0
MOV TMOD,#00000001B
SETB TR0

PETLA:
CLR D7
CALL CZAS_ON
CPL D7
CALL CZAS_OFF
SJMP PETLA

CZAS_ON:
MOV LICZNIK,#NrCYKL_ON

PETLA2:
MOV TH0,#HIGH CZAS_50
MOV TL0,#LOW CZAS_50
JNB TF0,$
CLR TF0
DJNZ LICZNIK,PETLA2
RET

CZAS_OFF:
MOV LICZNIK,#NrCYKL_OFF
MOV TMOD,#00000001B

SKOK:
MOV TH0,#HIGH CZAS_50
MOV TL0,#LOW CZAS_50
JNB TF0,$
CLR TF0
DJNZ LICZNIK,SKOK
RET
END